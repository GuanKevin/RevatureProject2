<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>denise question</title>

<script src="https://code.jquery.com/jquery-3.2.1.min.js"
	integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	crossorigin="anonymous"></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
	integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
	crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
	integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"
	crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
	integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
	crossorigin="anonymous"></script>


</head>
<body>
	<h3>Enter a new question</h3>
	<form action="#">
		<input type="text" id="level" placeholder="LEVEL"> <input
			type="text" id="question" placeholder="QUESTION"> <input
			type="text" id="answer" placeholder="ANSWER"> <input
			type="text" id="choiceOne" placeholder="CHOICE ONE"> <input
			type="text" id="choiceTwo" placeholder="CHOICE TWO"> <input
			type="text" id="choiceThree" placeholder="CHOICE THREE">
		<button id="add" class="btn btn-success">Add</button>
	</form>

	<div class="col-md-6">
		<table class="table table-striped">
			<thead>
				<tr>
					<th>Level</th>
					<th>Question</th>
					<th>Answer</th>
					<th>Choice One</th>
					<th>Choice Two</th>
					<th>Choice Three</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>


	<!-- HERE MAKE SURE AFTER SUBMITING TO GO CLEAR PAGE AND LOAD THE COURSE VIEW -->
	<button id="submit" class="btn btn-success">Submit</button>
</body>
<script type="text/javascript">
	$(document).ready(function() {
		refresh();
		
		function QuestionObj(level,question, answer, choiceOne, choiceTwo, choiceThree) {
			this.level = level;
			this.question = question;
			this.answer = answer;
			this.choiceOne = choiceOne;
			this.choiceTwo = choiceTwo;
			this.choiceThree = choiceThree;
		}
		
	/*  HERE CHANGE IT TO CLEAR THE VIEW AND LOAD THE COURSES VIEW */
	    $("#submit").click(function(){
	    
			$.ajax("http://localhost:7001/MathMaster/Tquestion/create", {
				method : "POST",
				success : function() {
					tablewipe();
					/* should clear view */
					console.log("good job denise");
				}
			});
		}) 
		
		// when add is clicked it will add a question to the list in the controller
		$("#add").click(function() {
		    $("#add").prop("disabled", true); 
			var level = $("#level").val();
			var question = $("#question").val();
			var answer = $("#answer").val();
			var choiceOne = $("#choiceOne").val();
			var choiceTwo = $("#choiceTwo").val();
			var choiceThree = $("#choiceThree").val();
			
			var questionCreated = new QuestionObj(level, question, answer, choiceOne, choiceTwo, choiceThree);
	
			$.ajax("http://localhost:7001/MathMaster/Tquestion/new/87", {/* 87 is the exam ID */
				method : "POST",
				data : JSON.stringify(questionCreated),
				headers : {
					/* "Accept" : "application/json", */
					"Content-Type" : "application/json"
				},
				success : function(response) {
				    $(".alert-success").text(response);
					$(".alert-success").fadeIn();
					window.setTimeout(function(response) {
						$(".alert-success").fadeOut();
						$("#add").prop("disabled", false);
					}, 3000);
					$("form")[0].reset(); //reset form fields in the form
					refresh();
				},
				error: function() {
					$(".alert-danger").fadeIn();
					window.setTimeout(function(response) {
						$(".alert-danger").fadeOut();
						$("#add").prop("disabled", false);
					}, 3000);
				}
			});
		    return false; 
		});
		
 		function refresh() {
			$.ajax("http://localhost:7001/MathMaster/Tquestion/all", {
				method : "GET",
				headers : {
					"Accept" : "application/json"
				},
/* 				dataType : "json",
 */				success : function(response) {
					console.log(response);
					tablewipe();
					tableload(response);
				}
			});
		} 
		
		// clears table body.. to reload with the new data
		function tablewipe() {
			$(".table tbody").empty();
		}
		function tableload(response) {
			$.each(response, function(index, temp) {
				$(".table tbody").append("<tr>");
				$(".table tbody").append("<td>" + temp.level + "</td>");
				$(".table tbody").append("<td>" + temp.question + "</td>");
				$(".table tbody").append("<td>" + temp.answer + "</td>");
				$(".table tbody").append("<td>" + temp.choiceOne + "</td>");
				$(".table tbody").append("<td>" + temp.choiceTwo + "</td>");
				$(".table tbody").append("<td>" + temp.choiceThree + "</td>");
				$(".table tbody").append("</tr>");
			});
		}
	});
</script>
</html>